#!/usr/bin/env bash
set -euo pipefail
img="${FONDO_MAP_IMAGE:-$HOME/.local/share/fondo/assets/map.jpg}"
if [[ "${1:-}" == "--check" ]]; then
  [[ -r "$img" ]] || exit 1
  if command -v jp2a >/dev/null 2>&1; then
    exit 0
  fi
  command -v chafa >/dev/null 2>&1
  exit $?
fi
while true; do
  if command -v jp2a >/dev/null 2>&1; then
    jp2a --colors -z --fill "$img"
  else
    chafa --colors full --animate off --size "$(tput cols)x$(tput lines)" "$img" 2>/dev/null || true
  fi
  sleep 1
done
